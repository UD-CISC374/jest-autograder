#!/usr/bin/env bash

###########################################################################################
#
#   Make autograder:
#       - Cleans up files (all .DS_Store, staging/target, staging/src/main/typescript*)
#       - Creates a top level zip of only the essential files required for the
#           autograder to actually run
#
###########################################################################################

# Root folder of autograder
DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && cd ../ && pwd )"

cd $DIR


echo "Removing node_modules directories"
find . -name node_modules -ls -and -exec /bin/rm -rf {} \;


find . -name ".DS_Store" -exec rm -rf {} \;
rm -f "$DIR"/Autograder.zip
rm -rf "$DIR"/staging_main/typescript/src/main/*
rm -rf "$DIR"/staging_main/typescript/coverage/*
rm -rf "$DIR"/staging_main/typescript/jest-output.json*
rm -rf "$DIR"/staging_test/typescript/src/*
zip -r Autograder.zip . -x "localautograder/*" "*.git*"
